/*!
    *
    * Wijmo Library 5.20221.857
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,l){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,l){e.__proto__=l}||function(e,l){for(var t in l)l.hasOwnProperty(t)&&(e[t]=l[t])})(e,l)};return function(e,l){extendStatics(e,l);function __(){this.constructor=e}e.prototype=null===l?Object.create(l):(__.prototype=l.prototype,new __)}}();!function(e){!function(l){!function(l){l.softDetail=function softDetail(){return e._getModule("wijmo.grid.detail")};l.softMultiRow=function softMultiRow(){return e._getModule("wijmo.grid.multirow")};l.softTransposed=function softTransposed(){return e._getModule("wijmo.grid.transposed")};l.softTransposedMultiRow=function softTransposedMultiRow(){return e._getModule("wijmo.grid.transposedmultirow")}}(l.xlsx||(l.xlsx={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var l;(function(l){"use strict";var t=function(){function FlexGridXlsxConverter(){}FlexGridXlsxConverter.save=function(l,t,o){var r=new e.xlsx.Workbook;this._saveFlexGridToWorkbook(r,l,t,!1,null);o&&r.save(o);return r};FlexGridXlsxConverter.saveAsync=function(l,t,o,r,n,s,i){var a=this,u=new e.xlsx.Workbook;if(!i){this._saveFlexGridToWorkbook(u,l,t,!1,null);o?u.saveAsync(o,(function(l){e.isFunction(r)&&r(l,u)}),n,null):e.isFunction(r)&&r(null,u);return u}var d=null!=o;this.cancelAsync((function(){var i,c=[l.collectionView&&l.collectionView.collectionChanged,l.columns&&l.columns.collectionChanged,l.rows&&l.rows.collectionChanged,l.resizedColumn,l.resizedRow],removeHandlers=function(){return c.forEach((function(e){e&&e.removeHandler(restart)}))},restart=function(){a._cs&&a._cs.cancel(!1);clearTimeout(i);i=setTimeout((function(){removeHandlers();u=null;a.saveAsync(l,t,o,r,n,s)}),100)},finish=function(){clearTimeout(i);a._cs=null;removeHandlers()};a._cs=new e.xlsx._SyncPromise(null,finish);c.forEach((function(e){e&&e.addHandler(restart)}));a._saveFlexGridToWorkbook(u,l,t,!0,a._cs,(function(l){e.isFunction(s)&&s(d?Math.round(e.xlsx._map(l,0,100,0,50)):l)})).then((function(){if(o){u._externalCancellation=function(){return a._cs};u.saveAsync(o,(function(l){finish();e.isFunction(r)&&r(l,u)}),(function(l){finish();e.isFunction(n)&&n(l)}),(function(l){e.isFunction(s)&&s(Math.round(e.xlsx._map(l,0,100,51,100)))}))}else{finish();e.isFunction(s)&&s(100);e.isFunction(r)&&r(null,u)}}),(function(e){finish();throw e}))}));return null};FlexGridXlsxConverter.cancelAsync=function(l){var t=this;if(this._cs){this._cs.cancel();setTimeout((function(){t._cs=null;e.isFunction(l)&&l()}),100)}else e.isFunction(l)&&l()};FlexGridXlsxConverter.load=function(l,t,o){var r=this;if(t instanceof Blob)_blobToBuffer(t,(function(n){t=null;var s=new e.xlsx.Workbook;s.load(n,o?o.includeStyles:void 0);n=null;l.deferUpdate((function(){r._loadToFlexGrid(l,s,o);s=null}))}));else if(t instanceof e.xlsx.Workbook)l.deferUpdate((function(){r._loadToFlexGrid(l,t,o);t=null}));else{if(!(t instanceof ArrayBuffer||e.isString(t)))throw"Invalid workbook.";var n=new e.xlsx.Workbook;n.load(t,o?o.includeStyles:void 0);t=null;l.deferUpdate((function(){r._loadToFlexGrid(l,n,o);n=null}))}};FlexGridXlsxConverter.loadAsync=function(l,t,o,r,n){var s=this;if(t instanceof Blob)_blobToBuffer(t,(function(i){t=null;var a=new e.xlsx.Workbook;a.loadAsync(i,(function(){i=null;l.deferUpdate((function(){s._loadToFlexGrid(l,a,o);r&&r(a);a=null}))}),n,o?o.includeStyles:void 0)}));else if(t instanceof e.xlsx.Workbook)l.deferUpdate((function(){s._loadToFlexGrid(l,t,o);r&&r(t);t=null}));else{if(!(t instanceof ArrayBuffer||e.isString(t)))throw"Invalid workbook.";var i=new e.xlsx.Workbook;i.loadAsync(t,(function(){t=null;l.deferUpdate((function(){s._loadToFlexGrid(l,i,o);r&&r(i);i=null}))}),n,o?o.includeStyles:void 0)}};FlexGridXlsxConverter._saveFlexGridToWorkbook=function(t,r,i,a,u,d){var c=new e.xlsx._SyncPromise(u),f=new e.xlsx.WorkSheet,h=!i||null==i.includeColumnHeaders||i.includeColumnHeaders,x=!(!i||null==i.includeRowHeaders)&&i.includeRowHeaders,p=o.Cache,g=i?i.includeColumns:null,m=i?i.formatItem:null,v=[],w=i&&null!=i.convertHtmlEntities?e.asEnum(i.convertHtmlEntities,n):n.Auto;if(i){null!=i.includeCellStyles&&e._deprecated("includeCellStyles","includeStyles");p=!1===e.asBoolean(null!=i.includeStyles?i.includeStyles:i.includeCellStyles,!0)?o.None:!1===e.asBoolean(i.quickCellStyles,!0)?o.Regular:o.Cache}var y=p===o.Cache?new s(500):null;null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style);f.name=i?i.sheetName:"";f.visible=!i||!1!==i.sheetVisible;f.rightToLeft=r.rightToLeft;var C,_=r.wj_sheetInfo;if(_&&_.tables&&_.tables.length>0)for(var b=0;b<_.tables.length;b++)f.tables.push(_.tables[b]);if(!_&&(p!==o.None||m)){(C=document.createElement("div")).style.visibility="hidden";C.setAttribute(e.grid.FlexGrid._WJS_MEASURE,"true");r.hostElement.appendChild(C)}var T=x?r.rowHeaders.columns.length:0,S=this._getPerRowColumnsSettings(r,x?[r.topLeftCells,r.columnHeaders]:[r.columnHeaders]),F=S.cols,k=l.softMultiRow()&&r instanceof l.softMultiRow().MultiRow?this._getPerRowColumnsSettings(r,x?[r.rowHeaders,r.cells]:[r.cells],r.rowsPerItem).cols:null,R=F.length,W=[[r.topLeftCells,r.columnHeaders],[r.rowHeaders,r.cells],[r.bottomLeftCells,r.columnFooters]];h||W.shift();var A=W.map((function(e){return e[1].rows.length})).reduce((function(e,l){return e+l}));F.length&&F[0].forEach((function(l,t){var o=S.bndCols[0][t];if(!(t>=T&&g)||g(o)){var r=new e.xlsx.WorkbookColumn;r._deserialize(l);f._addWorkbookColumn(r)}}));this._saveContentToWorksheet(u,a,Date.now(),0,{panels:W,panelIdx:0,globRowIdx:0,rowsOffset:0,totalRows:A},r,f,x,(function(l){return l==e.grid.CellType.Cell&&k?k:F}),p,C,v,y,g,w,m,(function(e){d(Math.round(e/A*100))}),(function(){var l=new e.xlsx.WorkbookFrozenPane;l.rows=h?r.frozenRows+R:r.frozenRows;l.columns=x?r.frozenColumns+T:r.frozenColumns;f.frozenPane=l;t._addWorkSheet(f);if(!_&&(p!==o.None||m)){r.hostElement.removeChild(C);v.forEach((function(e){return e.forEach((function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}))}))}y&&y.clear();t.activeWorksheet=i?i.activeWorksheet:null;c.resolve()}));return c};FlexGridXlsxConverter._saveContentToWorksheet=function(l,t,o,r,n,s,i,a,u,d,c,f,h,x,p,g,m,v){for(var w=this,y=d?20:200,_loop_1=function(_){if(l&&l.cancelled)return{value:void 0};if(t&&_-r>y&&Date.now()-o>100){setTimeout((function(){if(!l||!l.cancelled){m(_);w._saveContentToWorksheet(l,t,Date.now(),_,n,s,i,a,u,d,c,f,h,x,p,g,m,v)}}),0);return{value:void 0}}for(;_-n.rowsOffset>=n.panels[n.panelIdx][1].rows.length;){n.rowsOffset+=n.panels[n.panelIdx][1].rows.length;n.panelIdx++}var b=n.panels[n.panelIdx],T=b[0],S=b[1],F=_-n.rowsOffset,k=S.rows[F];if(S.cellType!==e.grid.CellType.Cell&&k.renderSize<=0||k instanceof e.grid._NewRowTemplate)return"continue";var R=0,W={},A=new e.xlsx.WorkbookRow,G=k instanceof e.grid.GroupRow,B=0;S.cellType===e.grid.CellType.Cell&&(G?B=k.level:s.rows.maxGroupLevel>-1&&(B=s.rows.maxGroupLevel+1));var N=u(S.cellType);a&&(R=C._parseFlexGridRowToSheetRow(i,T,W,F,0,N,d,c,f,h,G,B,x,p,g));C._parseFlexGridRowToSheetRow(i,S,W,F,R,N,d,c,f,h,G,B,x,p,g);if(W.cells.length>0){A._deserialize(W);i._addWorkbookRow(A,n.globRowIdx)}n.globRowIdx++},C=this,_=r;_<n.totalRows;_++){var b=_loop_1(_);if("object"==typeof b)return b.value}e.isFunction(v)&&v()};FlexGridXlsxConverter._loadToFlexGrid=function(t,o,r){if(l.softTransposedMultiRow()&&t instanceof l.softTransposedMultiRow().TransposedMultiRow)throw"Not supported.";r=r||{};var n,s=null!=t.wj_sheetInfo,i={},a=[],u=[],d={};t.itemsSource=null;t.columns.clear();t.columnHeaders.rows.clear();t.rows.clear();t.frozenColumns=0;t.frozenRows=0;var c=null==r.sheetIndex||isNaN(r.sheetIndex)?0:r.sheetIndex;if(c<0||c>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=r.sheetName)for(var f=0;f<o.sheets.length;f++)if(r.sheetName===o.sheets[f].name){n=o.sheets[f];break}if(null!=(n=n||o.sheets[c]).rows){for(var h=this._getColumnCount(n.rows),x=this._getRowCount(n.rows,h),p=n.columns,g=0;g<h;g++){t.columns.push(new e.grid.Column);if(p[g]){isNaN(+p[g].width)||(t.columns[g].width=+p[g].width);p[g].visible||null==p[g].visible||(t.columns[g].visible=!!p[g].visible);p[g].style&&p[g].style.wordWrap&&(t.columns[g].wordWrap=p[g].style.wordWrap)}}var m,v=(null==r.includeColumnHeaders||r.includeColumnHeaders)&&n.rows.length>0,w=v?this._getColumnHeadersHeight(n):0,y=!1,C=[],_=n.frozenPane&&n.frozenPane.rows,b=n.frozenPane&&n.frozenPane.columns;_=e.isNumber(_)&&!isNaN(_)?_:null;b=e.isNumber(b)&&!isNaN(b)?b:null;for(var T=w;T<x;T++){var S=!1,F=null,k=n.rows[T];if(k)for(var R=T+1;R<n.rows.length;){var W=n.rows[R];if(W){(isNaN(k.groupLevel)&&!isNaN(W.groupLevel)||!isNaN(k.groupLevel)&&k.groupLevel<W.groupLevel)&&(S=!0);break}R++}if(S&&!n.summaryBelow){m&&(m.isCollapsed=y);(m=new e.grid.GroupRow).isReadOnly=!1;y=null!=k.collapsed&&k.collapsed;m.level=isNaN(k.groupLevel)?0:k.groupLevel;d[m.level]=y;this._checkParentCollapsed(d,m.level)&&m._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);t.rows.push(m)}else{var A=new e.grid.Row;k&&this._checkParentCollapsed(d,k.groupLevel)&&A._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);t.rows.push(A)}k&&k.height&&!isNaN(k.height)&&(t.rows[T-w].height=k.height);for(g=0;g<h;g++)if(k){var G=k.cells[g],B=G?G.formula:null;B&&"="!==B[0]&&(B="="+B);if(G&&G.textRuns&&G.textRuns.length>0){t.rows[T-w].isContentHtml=!0;t.setCellData(T-w,g,this._parseTextRunsToHTML(G.textRuns))}else{var N=B&&s?B:this._getItemValue(G);t.setCellData(T-w,g,N,""!=N)}S||this._setColumn(C,g,G);var D=T*h+g,E=G?G.style:null;if(E){F=null==F?!!E.wordWrap:F&&!!E.wordWrap;if(s){var H=e.xlsx.Workbook._parseExcelFormat(G),I=void 0;if(E.hAlign)I=e.xlsx.Workbook._parseHAlignToString(e.asEnum(E.hAlign,e.xlsx.HAlign));else switch(this._getItemType(G)){case e.DataType.Number:I="right";break;case e.DataType.Boolean:I="center";break;default:I=H&&0===H.search(/[n,c,p]/i)?"right":"left"}i[D]={fontWeight:E.font&&E.font.bold?"bold":"none",fontStyle:E.font&&E.font.italic?"italic":"none",textDecoration:E.font&&E.font.underline?"underline":"none",textAlign:I,fontFamily:E.font&&E.font.family?E.font.family:"",fontSize:E.font&&E.font.size?E.font.size+"px":"",color:E.font&&E.font.color?E.font.color:"",backgroundColor:E.fill&&E.fill.color?E.fill.color:"",whiteSpace:E.wordWrap?"pre-wrap":"normal",format:H};if(E.borders){if(E.borders.left){this._parseBorderStyle(E.borders.left.style,"Left",i[D]);i[D].borderLeftColor=E.borders.left.color}if(E.borders.right){this._parseBorderStyle(E.borders.right.style,"Right",i[D]);i[D].borderRightColor=E.borders.right.color}if(E.borders.top){this._parseBorderStyle(E.borders.top.style,"Top",i[D]);i[D].borderTopColor=E.borders.top.color}if(E.borders.bottom){this._parseBorderStyle(E.borders.bottom.style,"Bottom",i[D]);i[D].borderBottomColor=E.borders.bottom.color}}if(E.fill&&E.fill.color){var M=i[D],X=E.borders,z=E.fill.color;if(X){X.left&&X.left.color||(M.borderLeftColor=z);X.right&&X.right.color||g===b-1||(M.borderRightColor=z);X.top&&X.top.color||(M.borderTopColor=z);X.bottom&&X.bottom.color||T===_-1||(M.borderBottomColor=z)}else{M.borderLeftColor=z;g!==b-1&&(M.borderRightColor=z);M.borderTopColor=z;T!==_-1&&(M.borderBottomColor=z)}}E.font&&-1===u.indexOf(E.font.family)&&u.push(E.font.family)}}s&&G&&e.isNumber(G.rowSpan)&&G.rowSpan>0&&e.isNumber(G.colSpan)&&G.colSpan>0&&(G.rowSpan>1||G.colSpan>1)&&a.push(new e.grid.CellRange(T,g,T+G.rowSpan-1,g+G.colSpan-1))}if(k){this._checkParentCollapsed(d,k.groupLevel)||k.visible||null==k.visible||(t.rows[T-w].visible=k.visible);t.rows[T-w].wordWrap=!!k.style&&!!k.style.wordWrap||!!F}}m&&(m.isCollapsed=y);null!=b&&(t.frozenColumns=b);null!=_&&(t.frozenRows=v&&_>0?_-1:_);for(g=0;g<t.columnHeaders.columns.length;g++){var L=C[g],O=t.columns[g];O.isRequired=!1;if(L){L.dataType===e.DataType.Boolean&&(O.dataType=L.dataType);O.format=L.format;O.align=L.hAlign;O.wordWrap=O.wordWrap||!!L.wordWrap}}for(f=0;f<Math.max(w,1);f++)t.columnHeaders.rows.push(new e.grid.Row);for(f=0;f<w;f++)for(var j=0;j<t.columnHeaders.columns.length;j++){var P=n.rows[f]?n.rows[f].cells[j]:null,V=P&&null!=P.value?P.value:"",U=t.columnHeaders.columns[j];if(V){var Y=e.xlsx.Workbook._parseExcelFormat(P);V=e.Globalize.format(V,Y)}U.header=U.header||V;t.columnHeaders.setCellData(f,j,V)}if(s){var q=null!=r.sheetVisible?r.sheetVisible:!1!==n.visible;t.wj_sheetInfo.name=n.name;t.wj_sheetInfo.visible=q;t.wj_sheetInfo.styledCells=i;t.wj_sheetInfo.mergedRanges=a;t.wj_sheetInfo.fonts=u;t.wj_sheetInfo.tables=n.tables}}};FlexGridXlsxConverter._getColumnHeadersHeight=function(e){var l;if(!e||!(l=e.rows).length)return 0;if(!l[0])return 1;for(var t=0,o=1;t<l.length&&o>0;t++,o--){var r=l[t].cells.reduce((function(e,l){return Math.max(e,l.rowSpan||0)}),1);r>o&&(o=r)}return t};FlexGridXlsxConverter._escapePlainText=function(e){return null==e?"":""===e?"'":"'"===e[0]||e.length>1&&"="===e[0]&&"="===e[1]?"'"+e:e};FlexGridXlsxConverter._parseFlexGridRowToSheetRow=function(t,s,i,a,u,d,c,f,h,x,p,g,m,v,w){var y=s.grid,C=y.wj_sheetInfo,_=s.rows[a],b=0,T=C&&C.evaluateFormula;null==_.recordIndex?s.cellType===e.grid.CellType.ColumnHeader&&s.rows.length>1&&(b=Math.min(a,d.length-1)):b=_.recordIndex;i.cells||(i.cells=[]);i.visible=_.isVisible;i.height=_.renderHeight||s.rows.defaultSize;i.groupLevel=g;p&&(i.collapsed=_.isCollapsed);_.wordWrap&&(i.style={wordWrap:_.wordWrap});for(var S,F=_.constructor===e.grid.Row||_.constructor===e.grid._NewRowTemplate||l.softTransposed()&&y instanceof l.softTransposed().TransposedGrid&&_ instanceof e.grid.Row||l.softDetail()&&_.constructor===l.softDetail().DetailRow||l.softMultiRow()&&_.constructor===l.softMultiRow()._MultiRow||l.softTransposedMultiRow()&&_ instanceof l.softTransposedMultiRow()._MultiRow,k=l.softDetail()&&_.constructor===l.softDetail().DetailRow,R=0,W=Math.round(e.xlsx._xlsx._parsePixelToCharWidth(y.treeIndent)||0),getTreeIndent=function(e){return e*W},A=!1;R<s.columns.length;R++){var G=void 0,B=void 0,N=void 0,D=1,E=1,H=!1,I=y._getBindingColumn(s,a,s.columns[R]),M=0;if(C&&s===y.cells){var X=a*s.columns.length+R;C.mergedRanges&&(G=this._getMergedRange(a,R,C.mergedRanges));C.styledCells&&(B=C.styledCells[X])}else if(c!==o.None){N=this._getMeasureCell(s,R,f,h);B=(G=y.getMergedRange(s,a,R,!1))?this._getCellStyle(s,N,G.bottomRow,G.rightCol,x,!!w)||{}:this._getCellStyle(s,N,a,R,x,!!w)||{}}G||(G=y.getMergedRange(s,a,R,!1));if(G){if(a===G.topRow&&R===G.leftCol){E=G.bottomRow-G.topRow+1;D=this._getColSpan(s,G,m);H=!0}if(R>G.leftCol&&R<=G.rightCol&&A){H=!0;A=!1;D=G.rightCol-R+1}}else H=!0;if(!m||m(I)){var z=d[b]?d[b][R+u]:null,L=void 0,O=void 0,j=void 0,P=void 0,V=void 0,U=void 0,Y=void 0;if(F||p){j=H?s.getCellData(a,R,!0):null;P=H?s.getCellData(a,R,!1):null;O=this._isFormula(j);L=null;V=e.isDate(P);if(s.cellType===e.grid.CellType.ColumnHeader&&e.isString(j))Y="General";else if(B&&B.format){U=B.format;/[hsmyt\:]/i.test(U)&&(V=!0);Y=e.xlsx.Workbook._parseCellFormat(B.format,V)}else if(z&&z.style&&z.style.format){U=I.format;Y=z.style.format}else Y=null;O&&null!=T&&e.isFunction(T)&&(L=T(j));if(!Y)if(V)Y="m/d/yyyy";else if(e.isNumber(P)&&!I.dataMap)Y=e.isInt(P)?"#,##0":"#,##0.00";else if(O){var q=j.toLowerCase();if(q.indexOf("now()")>-1){Y="m/d/yyyy h:mm";V=!0}else if(q.indexOf("today()")>-1||q.indexOf("date(")>-1){Y="m/d/yyyy";V=!0}else if(q.indexOf("time(")>-1){Y="h:mm AM/PM";V=!0}}else Y="General"}else{j=H?y.columnHeaders.getCellData(0,R,!0):null;Y="General"}var J=void 0;if(e.isString(j)&&"{"!==j[0]&&-1!==j.indexOf("<span")){J=this._parseToTextRuns(j);j=null}var K=this._parseCellStyle(B)||{};if(s===y.cells&&p&&_.hasChildren&&R===y.columns.firstVisibleIndex){var $=void 0;if(O&&null!=L)$=L;else{j?$=j:H&&($=_.getGroupHeader());$&&($=$.replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'"))}if(null==$&&!B)continue;!(V=e.isDate($))&&U&&"d"===U.toLowerCase()&&e.isInt($)&&(Y="0");$=e.isString($)?e.xlsx.Workbook._unescapeXML($):$;R===y.columns.firstVisibleIndex&&y.treeIndent&&(M=getTreeIndent(g));S={value:$,isDate:V,formula:O?this._parseToExcelFormula(j,V):null,colSpan:D,rowSpan:E,style:this._extend(K,{format:Y,font:y.childItemsPath?{}:{bold:!0},hAlign:t.rightToLeft?e.xlsx.HAlign.Right:e.xlsx.HAlign.Left,indent:M}),textRuns:J}}else{if(p||v===n.Auto&&I.isContentHtml||v===n.Yes){j=e.isString(j)?e.xlsx.Workbook._unescapeXML(j):j;P=e.isString(P)?e.xlsx.Workbook._unescapeXML(P):P}!V&&U&&"d"===U.toLowerCase()&&e.isInt(P)&&(Y="0");var Q=void 0;Q=K&&K.hAlign?K.hAlign:z&&z.style&&null!=z.style.hAlign?e.asEnum(z.style.hAlign,e.xlsx.HAlign,!0):e.isDate(P)?e.xlsx.HAlign.Left:e.xlsx.HAlign.General;s===y.cells&&R===y.columns.firstVisibleIndex&&y.treeIndent&&(t.rightToLeft&&Q===e.xlsx.HAlign.Right||!t.rightToLeft&&Q===e.xlsx.HAlign.Left||Q===e.xlsx.HAlign.General)&&(M=getTreeIndent(g));S={value:O?L:"General"!==Y||""===j&&null==P||!0===P||!1===P?this._escapePlainText(P):this._escapePlainText(j),isDate:V,formula:O?this._parseToExcelFormula(j,V):null,colSpan:R<y.columns.firstVisibleIndex?1:D,rowSpan:E,style:this._extend(K,{format:Y,hAlign:Q,vAlign:E>1?s===y.cells||!1===y.centerHeadersVertically?e.xlsx.VAlign.Top:e.xlsx.VAlign.Center:null,indent:M}),textRuns:J}}w&&w(new r(s,new e.grid.CellRange(a,R),N,f,h,x,S));if(k){var Z=s.getCellElement(a,R);if(Z){var ee=_.detail;Z.appendChild(ee);e.Control.refreshAll(ee)}}i.cells.push(S)}else A=H}return u+R};FlexGridXlsxConverter._parseCellStyle=function(l,t){void 0===t&&(t=!1);if(null==l)return null;var o=l.fontSize;o=o?+o.substring(0,o.indexOf("px")):null;isNaN(o)&&(o=null);var r=l.whiteSpace;r=!!r&&r.indexOf("pre")>-1;var n=l.textAlign;"start"===n&&(n="rtl"===l.direction?"right":"left");"end"===n&&(n="rtl"===l.direction?"left":"right");return{font:{bold:"bold"===l.fontWeight||+l.fontWeight>=700,italic:"italic"===l.fontStyle,underline:"underline"===(l.textDecorationStyle||l.textDecoration),family:this._parseToExcelFontFamily(l.fontFamily),size:o,color:l.color},fill:{color:l.backgroundColor},borders:this._parseBorder(l,t),hAlign:e.xlsx.Workbook._parseStringToHAlign(n),wordWrap:r}};FlexGridXlsxConverter._parseBorder=function(e,l){var t={left:this._parseEgdeBorder(e,"Left"),right:this._parseEgdeBorder(e,"Right"),top:this._parseEgdeBorder(e,"Top"),bottom:this._parseEgdeBorder(e,"Bottom")};if(l){t.vertical=this._parseEgdeBorder(e,"Vertical");t.horizontal=this._parseEgdeBorder(e,"Horizontal")}return t};FlexGridXlsxConverter._parseEgdeBorder=function(l,t){var o,r=l["border"+t+"Style"],n=l["border"+t+"Width"];n&&(n=parseFloat(n));if(r&&"none"!==r&&"hidden"!==r&&0!==n){o={};switch(r=r.toLowerCase()){case"dotted":o.style=n>1?e.xlsx.BorderStyle.MediumDashDotted:e.xlsx.BorderStyle.Dotted;break;case"dashed":o.style=n>1?e.xlsx.BorderStyle.MediumDashed:e.xlsx.BorderStyle.Dashed;break;case"double":o.style=e.xlsx.BorderStyle.Double;break;default:o.style=n>2?e.xlsx.BorderStyle.Thick:n>1?e.xlsx.BorderStyle.Medium:e.xlsx.BorderStyle.Thin}o.color=l["border"+t+"Color"]}return o};FlexGridXlsxConverter._parseBorderStyle=function(l,t,o){var r="border"+t+"Style",n="border"+t+"Width";switch(l){case e.xlsx.BorderStyle.Dotted:case e.xlsx.BorderStyle.Hair:o[r]="dotted";o[n]="1px";break;case e.xlsx.BorderStyle.Dashed:case e.xlsx.BorderStyle.ThinDashDotDotted:case e.xlsx.BorderStyle.ThinDashDotted:o[r]="dashed";o[n]="1px";break;case e.xlsx.BorderStyle.MediumDashed:case e.xlsx.BorderStyle.MediumDashDotDotted:case e.xlsx.BorderStyle.MediumDashDotted:case e.xlsx.BorderStyle.SlantedMediumDashDotted:o[r]="dashed";o[n]="2px";break;case e.xlsx.BorderStyle.Double:o[r]="double";o[n]="3px";break;case e.xlsx.BorderStyle.Medium:o[r]="solid";o[n]="2px";break;case e.xlsx.BorderStyle.Thick:o[r]="solid";o[n]="3px";break;default:o[r]="solid";o[n]="1px"}};FlexGridXlsxConverter._parseToExcelFontFamily=function(e){var l;e&&(l=e.split(","))&&l.length>0&&(e=l[0].replace(/\"|\'/g,""));return e};FlexGridXlsxConverter._parseToExcelFormula=function(l,t){var o=l.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi);if(o)for(var r=0;r<o.length;r++){var n=(i=o[r]).substring(0,i.lastIndexOf(")"))+", 1)";l=l.replace(i,n)}o=null;if(o=l.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi)){var s=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;for(r=0;r<o.length;r++){var i,a=(i=o[r]).match(s);if(a&&2===a.length){var u=a[1];if(!/^d{1,4}?$/.test(u)){var d=e.xlsx.Workbook._parseCellFormat(u,t);n=i.replace(u,d);l=l.replace(i,n)}}}}return l};FlexGridXlsxConverter._parseToTextRuns=function(e){for(var l=e.split("<span "),t=[],o=0;o<l.length;o++){var r=l[o],n=void 0;n=-1!==r.indexOf("</span>")?{text:r.substring(r.indexOf(">")+1,r.indexOf("</span>")),font:this._parseToTextRunFont(r.substring(r.indexOf('style="')+7,r.indexOf(';"')))}:{text:r};t.push(n)}return t};FlexGridXlsxConverter._parseToTextRunFont=function(e){var l,t=e.split(";");if(t.length>0){for(var o=void 0,r=void 0,n=void 0,s=void 0,i=void 0,a=void 0,u=0;u<t.length;u++){var d=t[u].split(":");if(2===d.length){d[1]=d[1].trim();switch(d[0]){case"font-size":s=+d[1].substring(0,d[1].indexOf("px"));isNaN(s)&&(s=null);break;case"font-weight":o="bold"===d[1]||+d[1]>=700;break;case"font-style":r="italic"===d[1];break;case"text-decoration-style":case"text-decoration":n="underline"===d[1];break;case"font-family":i=this._parseToExcelFontFamily(d[1]);break;case"color":a=d[1]}}}l={bold:o,italic:r,underline:n,family:i,size:s,color:a}}return l};FlexGridXlsxConverter._getMeasureCell=function(e,l,t,o){var r=o[e.cellType],n=r&&r[l],s=null==n;if(n){if(this.hasCssText){n.style.cssText="";n.style.visibility="hidden"}}else{r||(o[e.cellType]=r=[]);r[l]=n=t.cloneNode()}!s&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n));return n};FlexGridXlsxConverter._getColumnSetting=function(l,t,o){var r=l;null!=l.colspan&&(r=this._getRenderColumn(t,o));return r?{autoWidth:!0,width:r.renderWidth||o.defaultSize,visible:r.visible&&0!==r.width&&!r._getFlag(e.grid.RowColFlags.ParentCollapsed),style:{format:l.format?e.xlsx.Workbook._parseCellFormat(l.format,l.dataType===e.DataType.Date):"",hAlign:e.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(r.getAlignment())),wordWrap:r.wordWrap}}:null};FlexGridXlsxConverter._getPerRowColumnsSettings=function(e,l,t){var o=this,r=[],n=[];l.forEach((function(s,i){for(var a=0,u=i>0?l[0].columns.length:0,_loop_2=function(l){if(null!=t&&l>=t)return"break";if(s.rows[l].renderSize<=0)return"continue";r[a]=r[a]||[];n[a]=n[a]||[];s.columns.forEach((function(t,i){var d=e._getBindingColumn(s,l,t),c=o._getColumnSetting(d,i,s.columns);if(c){r[a][u+i]=c;n[a][u+i]=d}}));a++},d=0;d<s.rows.length&&"break"!==_loop_2(d);d++);}));return{cols:r,bndCols:n}};FlexGridXlsxConverter._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e};FlexGridXlsxConverter._getColumnCount=function(l){for(var t=0,o=0;o<l.length;o++){var r=l[o]&&l[o].cells?l[o].cells:[];if(r&&r.length>0){var n=r.length;e.isInt(r[n-1].colSpan)&&r[n-1].colSpan>1&&(n=n+r[n-1].colSpan-1);n>t&&(t=n)}}return t};FlexGridXlsxConverter._getRowCount=function(l,t){for(var o=l.length,r=o-1,n=0;n<t;n++)e:for(;r>=0;r--){var s=l[r],i=(s&&s.cells?s.cells:[])[n];if(i&&(null!=i.value&&""!==i.value||e.isInt(i.rowSpan)&&i.rowSpan>1)){e.isInt(i.rowSpan)&&i.rowSpan>1&&r+i.rowSpan>o&&(o=r+i.rowSpan);break e}}return o};FlexGridXlsxConverter._numAlpha=function(e){var l=Math.floor(e/26)-1;return(l>-1?this._numAlpha(l):"")+String.fromCharCode(65+e%26)};FlexGridXlsxConverter._getItemType=function(l){return null==l||null==l.value||isNaN(l.value)?null:e.getType(l.value)};FlexGridXlsxConverter._setColumn=function(l,t,o){var r=l[t],n=this._getItemType(o);n===e.DataType.Boolean&&o.formula&&(n=null);if(r){r.dataType!==n&&r.dataType===e.DataType.Boolean&&n!==e.DataType.Boolean&&(r.dataType=n);if(o&&null!=o.value&&(!e.isString(o.value)||!e.isNullOrWhiteSpace(o.value))){var s=e.xlsx.Workbook._parseExcelFormat(o);s&&r.format!==s&&"General"!==s&&(r.format=s)}var i=void 0;if(o&&o.style){o.style.hAlign&&(i=e.xlsx.Workbook._parseHAlignToString(e.asEnum(o.style.hAlign,e.xlsx.HAlign)));null==r.wordWrap?r.wordWrap=!!o.style.wordWrap:r.wordWrap=r.wordWrap&&!!o.style.wordWrap}i||n!==e.DataType.Number||(i="right");r.hAlign=i}else l[t]={dataType:n,format:e.xlsx.Workbook._parseExcelFormat(o),hAlign:"",wordWrap:null}};FlexGridXlsxConverter._getItemValue=function(l){if(null==l||null==l.value)return null;var t=l.value;e.isString(t)&&"'"===t[0]&&(t=t.substr(1));return e.isNumber(t)&&isNaN(t)?"":t instanceof Date&&isNaN(t.getTime())?"":t};FlexGridXlsxConverter._getCellStyle=function(e,l,t,o,r,n){var s,i=e.grid;try{var a=!(r&&!i.formatItem.hasHandlers&&!i.itemFormatter&&!n);i.cellFactory.updateCell(e,t,o,l,null,a);l.className=l.className.replace("wj-state-selected","");l.className=l.className.replace("wj-state-multi-selected","")}catch(e){return null}if(r){var u=e.hostElement,d=l,c=d.style.cssText.split(/;\s+/).filter((function(e){var l=e.substring(0,e.indexOf(":"));return/^(color|background|border|font|text|whitespace)/i.test(l)})).join(";");do{c=d.className+c}while(d!==u&&(d=d.parentElement));if(!(s=r.getValue(c))){s=window.getComputedStyle(l);r.add(c,s)}}else s=window.getComputedStyle(l);return s};FlexGridXlsxConverter._parseTextRunsToHTML=function(e){for(var l="",t=0;t<e.length;t++){var o=e[t],r=o.font;l+=r?'<span style="'+(r.bold?"font-weight: bold;":"")+(r.italic?"font-style: italic;":"")+(r.underline?"text-decoration: underline;":"")+(r.family?"font-family: "+r.family+";":"")+(null!=r.size?"font-size: "+r.size+"px;":"")+(r.color?"color: "+r.color+";":"")+'">'+o.text+"</span>":o.text}return l};FlexGridXlsxConverter._extend=function(l,t){for(var o in t){var r=t[o];e.isObject(r)&&l[o]?e.copy(l[o],r):l[o]=r}return l};FlexGridXlsxConverter._checkParentCollapsed=function(e,l){var t=!1;Object.keys(e).forEach((function(o){!0===e[o]&&!1===t&&!isNaN(l)&&+o<l&&(t=!0)}));return t};FlexGridXlsxConverter._getColSpan=function(e,l,t){for(var o=0,r=l.leftCol;r<=l.rightCol;r++)t&&!t(e.columns[r])||o++;return o};FlexGridXlsxConverter._getRenderColumn=function(e,l){return e>=l.length?null:l[e]};FlexGridXlsxConverter._getMergedRange=function(e,l,t){for(var o=0;o<t.length;o++){var r=t[o];if(e>=r.topRow&&e<=r.bottomRow&&l>=r.leftCol&&l<=r.rightCol)return r}return null};FlexGridXlsxConverter._isFormula=function(e){return e&&"string"==typeof e&&e.length>1&&"="===e[0]&&"="!==e[1]};return FlexGridXlsxConverter}();l.FlexGridXlsxConverter=t;var o,r=function(e){__extends(XlsxFormatItemEventArgs,e);function XlsxFormatItemEventArgs(l,t,o,r,n,s,i){var a=e.call(this,l,t)||this;a._cell=o;a._patternCell=r;a._xlsxCell=i;a._cellsCache=n;a._styleCache=s;return a}Object.defineProperty(XlsxFormatItemEventArgs.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(XlsxFormatItemEventArgs.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0});XlsxFormatItemEventArgs.prototype.getFormattedCell=function(){if(!this._cell){this._cell=t._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache);t._getCellStyle(this.panel,this._cell,this.row,this.col,this._styleCache,!0)}return this._cell};return XlsxFormatItemEventArgs}(e.grid.CellRangeEventArgs);l.XlsxFormatItemEventArgs=r;!function(e){e[e.None=0]="None";e[e.Regular=1]="Regular";e[e.Cache=2]="Cache"}(o||(o={}));var n,s=function(){function _StyleCache(e){this._cache={};this._size=0;this._max=e}_StyleCache.prototype.add=function(e,l){this._size>=this._max&&this.clear();this._cache[e]=this._cloneStyle(l);this._size++};_StyleCache.prototype.clear=function(){this._cache={};this._size=0};_StyleCache.prototype.getValue=function(e){return this._cache[e]||null};_StyleCache.prototype.hasKey=function(e){return!!this._cache[e]};_StyleCache.prototype._cloneStyle=function(e){if(!e)return null;for(var l={},toCamel=function(e){return e.replace(/\-([a-z])/g,(function(e,l,t){return t>0?l.toUpperCase():l}))},t=0,o=e.length;t<o;t++){var r=e[t];l[toCamel(r)]=e.getPropertyValue(r)}return l};return _StyleCache}();l._StyleCache=s;function _blobToBuffer(e,l){if(e&&l)if(e.arrayBuffer)e.arrayBuffer().then((function(e){return l(e)}));else{var t=new FileReader;t.onload=function(){l(t.result);t=null};t.readAsArrayBuffer(e)}}l._blobToBuffer=_blobToBuffer;!function(e){e[e.Auto=0]="Auto";e[e.No=1]="No";e[e.Yes=2]="Yes"}(n=l.HtmlEntityConversion||(l.HtmlEntityConversion={}))})((l=e.grid||(e.grid={})).xlsx||(l.xlsx={}))}(wijmo||(wijmo={}));!function(e){!function(l){l.xlsx||(l.xlsx={}),e._registerModule("wijmo.grid.xlsx",e.grid.xlsx)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));