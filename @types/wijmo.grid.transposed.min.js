/*!
    *
    * Wijmo Library 5.20221.857
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,o){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var r in o)o.hasOwnProperty(r)&&(e[r]=o[r])})(e,o)};return function(e,o){extendStatics(e,o);function __(){this.constructor=e}e.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}}();!function(e){!function(o){!function(o){"use strict";var r=function(e){__extends(_MergeManager,e);function _MergeManager(){return null!==e&&e.apply(this,arguments)||this}_MergeManager.prototype.getMergedRange=function(o,r,t,n){void 0===n&&(n=!0);var i=o.grid,s=i._hasColumnGroups();if(o==i.columnHeaders&&s)return null;if(o==i.rowHeaders&&s){if(r<0||r>=o.rows.length||t<0||t>=o.columns.length)return null;var a=i._getColumnGroup(r,t);if(a){var l=a._rng,u=o.rows;if(u.isFrozen(l.row)!=u.isFrozen(l.row2)){l=l.clone();u.isFrozen(r)?l.row2=u.frozen-1:l.row=u.frozen}return l}return null}return e.prototype.getMergedRange.call(this,o,r,t,n)};return _MergeManager}(e.grid.MergeManager);o._MergeManager=r}(o.transposed||(o.transposed={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(o){!function(o){var r=function(r){__extends(TransposedGrid,r);function TransposedGrid(t,n){var i=r.call(this,t,null)||this;i._keyPrefix="item";i._autoGenRows=!0;e.addClass(i.hostElement,"wj-transposed-grid");i.allowSorting=e.grid.AllowSorting.None;i.headersVisibility=e.grid.HeadersVisibility.Row;i._rowInfo=new e.grid.ColumnCollection(i,i.columns.defaultSize);i._grpHdl=new o._RowGroupHandler(i);i.mergeManager=new o._MergeManager;i.initialize(n);i._rowInfo.collectionChanged.addHandler(i._rowInfoChanged,i);i.deferUpdate((function(){var e=i.rowHeaders.columns;if(e.length){e[e.length-1].width=i.columns.defaultSize}}));return i}Object.defineProperty(TransposedGrid.prototype,"autoGenerateRows",{get:function(){return this._autoGenRows},set:function(o){this._autoGenRows=e.asBoolean(o)},enumerable:!0,configurable:!0});Object.defineProperty(TransposedGrid.prototype,"rowGroups",{get:function(){return this._grpHdl.getGroupDefinitions()},set:function(o){var r=this;this._rowInfo.deferUpdate((function(){r.autoGenerateRows=!1;r._rowInfo.clear();r._grpHdl.createColumnGroups(e.asArray(o))}))},enumerable:!0,configurable:!0});TransposedGrid.prototype.refresh=function(e){var o=this._rowInfo;if(o._dirty){o._dirty=!1;this._rowInfoChanged()}else r.prototype.refresh.call(this,e)};Object.defineProperty(TransposedGrid.prototype,"allowAddNew",{get:function(){return!1},set:function(e){},enumerable:!0,configurable:!0});Object.defineProperty(TransposedGrid.prototype,"allowDelete",{get:function(){return!1},set:function(e){},enumerable:!0,configurable:!0});Object.defineProperty(TransposedGrid.prototype,"allowSorting",{get:function(){return e.grid.AllowSorting.None},set:function(o){e.assert(o===e.grid.AllowSorting.None,"TransposedGrid does not support sorting.");this._alSorting=o},enumerable:!0,configurable:!0});Object.defineProperty(TransposedGrid.prototype,"columnGroups",{get:function(){return null},set:function(e){throw"TransposedGrid does not support columnGroups, use rowGroups instead."},enumerable:!0,configurable:!0});TransposedGrid.prototype.onRowEditEnded=function(o){var t=e.tryCast(this._sourceItems,"ICollectionView");if(t){var n=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change);t.collectionChanged.raise(t,n)}r.prototype.onRowEditEnded.call(this,o)};TransposedGrid.prototype._getCollectionView=function(o){var t=this,n=e.tryCast(this._sourceItems,"ICollectionView");n&&n.collectionChanged.removeHandler(this._sourceViewChanged);n=e.tryCast(o,"ICollectionView");var i=o;if(e.isArray(o))i=this._transposeItemsSource(o);else if(n){n.collectionChanged.addHandler(this._sourceViewChanged,this);i=this._transposeItemsSource(n.items)}this.autoGenerateColumns=!0;var s=r.prototype._getCollectionView.call(this,i),a=null;n instanceof e.collections.CollectionView&&(a=n.getError);a&&s instanceof e.collections.CollectionView&&(this._supportsProxies()?s.getError=function(e,o){if(null==o)return null;var r=e._keys.indexOf(o);return a(e._arr[r],e._bnd.path)}:s.getError=function(e,o){if(null==o)return null;var r=parseInt(o.substr(t._keyPrefix.length));return a(e._arr[r],e._rowInfo.binding)});this._sourceItems=o;return s};TransposedGrid.prototype._getColumnTypes=function(o){var r,t=this;if(this._sourceItems)if(e.isArray(this._sourceItems))r=this._sourceItems;else{var n=e.tryCast(this._sourceItems,"ICollectionView");n&&(r=n.items)}return r?r.map((function(o,r){return{binding:t._keyPrefix+r,dataType:e.DataType.Object}})):e.getTypes(o)};TransposedGrid.prototype._copy=function(o,n){var i=this;if(/rows|columns/.test(o)){e.assert(e.isArray(n),"Array Expected.");var s=e.asArray(n);s.some((function(e){return null!=e.columns}))?this.rowGroups=s:this._rowInfo.deferUpdate((function(){i.autoGenerateRows=!1;i._rowInfo.clear();n.forEach((function(e){var o=new t(e);i._rowInfo.push(o)}))}));return!0}return r.prototype._copy.call(this,o,n)};TransposedGrid.prototype.onLoadedRows=function(o){for(var t=this,n=this.columns,i=0;i<n.length;i++){var s=n[i];s.align=null;s.dataType=0}var a=this.rowHeaders.columns;for(i=0;i<a.length;i++){a[i].align="left";a[i].width=0}var l=e.grid.FlexGrid._getSerializableProperties(e.grid.Row);this.rows.forEach((function(e){var o=e.dataItem._rowInfo;if(o){t._copyProps(o,e,l,["showDropDown","width","size"]);if(t._hasColumnGroups())for(var r=0;r<a.length;r++){var n=t._grpHdl.getColumnGroup(e.index,r);n&&t._updateRowHeaders(e.index,r,n)}else a.length&&t._updateRowHeaders(e.index,a.length-1,o)}}));for(i=0;i<a.length;i++)0===a[i].width&&(a[i].width=this.columns.defaultSize);r.prototype.onLoadedRows.call(this,o)};TransposedGrid.prototype._getBindingColumn=function(o,r,t){var n=t;if(o!=this.cells)return n;var i=o.rows[r].dataItem._rowInfo;if(e.isUndefined(i))return n;n=new e.grid.Column;var s=e.grid.FlexGrid._getSerializableProperties(e.grid.Column);this._copyProps(i,n,s);n.binding=t.binding;n.header=i.header||e.toHeaderCase(i.binding);return n};TransposedGrid.prototype._isTransposed=function(){return!0};TransposedGrid.prototype._autoSizeRows=function(){this.autoSizeMode&e.grid.AutoSizeMode.Both&&this.autoSizeRows()};TransposedGrid.prototype._copyProps=function(o,r,t,n){void 0===n&&(n=[]);for(var i in o)if(t.indexOf(i)>-1&&-1===n.indexOf(i)){var s=o[i];if(!e.isUndefined(s))try{r[i]=s}catch(e){}}};TransposedGrid.prototype._updateRowHeaders=function(o,r,t){var n=t.header||e.toHeaderCase(t.binding);this.rowHeaders.setCellData(o,r,n);var i=this.rowHeaders.columns,s=t.width;if(e.isNumber(s)&&s>0){var a=t._rng;if(a&&a instanceof e.grid.CellRange&&a.isValid){var l=a.columnSpan;e.assert(l>0,"Column span is negative or equal to 0");s/=l}i[r].width=Math.max(i[r].width,s)}};TransposedGrid.prototype._rowInfoChanged=function(){var o=this;this._toRowInfo&&clearTimeout(this._toRowInfo);this._toRowInfo=setTimeout((function(){var e=o.selection,r=o.itemsSource;o.itemsSource=null;o.itemsSource=r;o.selection=e}),e.Control._REFRESH_INTERVAL)};TransposedGrid.prototype._sourceViewChanged=function(e,o){this.activeEditor||this.invalidate()};TransposedGrid.prototype._transposeItemsSource=function(o){var r=this,t=new e.collections.ObservableArray,n=e.getTypes(o),i=o.map((function(e,o){return r._keyPrefix+o}));(this.autoGenerateRows?this._getRowInfo(o):this._rowInfo).forEach((function(s,a){var l=new e.Binding(s.binding);if(null==s.dataType&&o.length){var u=l.getValue(o[0]);s.dataType=null!=u?e.getType(u):n[a].dataType}if(r._supportsProxies()){var c=r._createProxy(o,s,i);t.push(c)}else{var p=r._createTransposedObject(o,s,r._keyPrefix);t.push(p)}}));o instanceof e.collections.ObservableArray&&o.collectionChanged.addHandler((function(o,n){if(n.action===e.collections.NotifyCollectionChangedAction.Change)r.activeEditor||r.invalidate();else{var i=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Reset);t.onCollectionChanged(i);r._rowInfoChanged()}}));return t};TransposedGrid.prototype._supportsProxies=function(){return null!=window.Proxy};TransposedGrid.prototype._createProxy=function(o,r,t){var n={_arr:o,_rowInfo:r,_bnd:new e.Binding(r.binding),_keys:t};return new Proxy(n,{ownKeys:function(e){return e._keys},getOwnPropertyDescriptor:function(){return{enumerable:!0,configurable:!0,writable:!0}},get:function(e,o){var r=e._keys.indexOf(o);return r>-1?e._bnd.getValue(e._arr[r]):e[o]},set:function(o,r,t){var n=o._keys.indexOf(r);if(n>-1){var i=o._arr,s=i[n];o._bnd.setValue(s,t);if(i instanceof e.collections.ObservableArray){var a=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,s,n);i.onCollectionChanged(a)}return!0}return!1}})};TransposedGrid.prototype._createTransposedObject=function(o,r,t){for(var n={_arr:o,_rowInfo:r},i=new e.Binding(r.binding),_loop_1=function(r){var s=o[r];Object.defineProperty(n,t+r,{enumerable:!0,get:function(){return i.getValue(s)},set:function(t){i.setValue(s,t);if(o instanceof e.collections.ObservableArray){var n=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,s,r);o.onCollectionChanged(n)}return!0}})},s=0;s<o.length;s++)_loop_1(s);return n};TransposedGrid.prototype._getRowInfo=function(o){var r=this,t=[];e.getTypes(o).forEach((function(o){var n=o.binding,i=o.dataType;if(i!=e.DataType.Object&&i!=e.DataType.Array){var s={binding:n,header:e.toHeaderCase(n),dataType:i},a=e.grid.FlexGrid._defTypeWidth[i];if(null!=a){if(e.isString(a)){var l=Math.round(parseFloat(a));a=a.indexOf("*")<0?l:l*r.columns.defaultSize}e.isNumber(a)&&a>0&&(s.width=a)}t.push(s)}}));return t};return TransposedGrid}(e.grid.FlexGrid);o.TransposedGrid=r;var t=function(e){__extends(TransposedGridRow,e);function TransposedGridRow(){return null!==e&&e.apply(this,arguments)||this}Object.defineProperty(TransposedGridRow.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0});return TransposedGridRow}(e.grid.Column);o.TransposedGridRow=t}(o.transposed||(o.transposed={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var o;(function(o){var r=function(){function _RowGroupHandler(e){this._grid=e}Object.defineProperty(_RowGroupHandler.prototype,"columnGroups",{get:function(){return null},enumerable:!0,configurable:!0});_RowGroupHandler.prototype.createColumnGroups=function(e){this._createRowGroups(e)};_RowGroupHandler.prototype.hasColumnGroups=function(){return null!=this._colGroups&&this._colGroups.length>0};_RowGroupHandler.prototype.getGroupDefinitions=function(){return this._groupDefs};_RowGroupHandler.prototype.getColumnGroup=function(e,o){var r=this._grid;if(o<r.rowHeaders.columns.length&&e<r._rowInfo.length)for(var t=this._colGroups;t;){for(var n=t,i=0;i<t.length;i++){var s=t[i],a=s._rng;if(a.containsRow(e)){if(a.containsColumn(o)||0==s.columns.length)return s;t=s.columns;break}}if(t==n)break}return null};_RowGroupHandler.prototype.canMoveColumnGroup=function(e,o,r,t){return this._grid.columns.canMoveElement(o,t)};_RowGroupHandler.prototype.moveColumnGroup=function(e,o,r,t,n){return this._grid.columns.moveElement(o,t)};_RowGroupHandler.prototype._createRowGroups=function(o){var r=this,n=this._grid;this._groupDefs=e.asArray(o);n.autoGenerateRows=!1;n._rowInfo.clear();this._colGroups=[];o.forEach((function(e){r._colGroups.push(new t(e,null))}));var i=1;this._colGroups.forEach((function(e){r._addRowGroup(e);i=Math.max(i,e._getMaxLevel())}));this._colGroups.forEach((function(e){e._expandRange(i)}));var s=n.rowHeaders.columns;s.clear();for(var a=0;a<=i;a++){var l=new e.grid.Column;s.splice(a,0,l);a<i&&(l.cssClassAll="wj-colgroup")}};_RowGroupHandler.prototype._addRowGroup=function(e){var o=this,r=this._grid;e._grid=r;e._rng.row=r._rowInfo.length;0==e.columns.length?r._rowInfo.push(e):e.columns.forEach((function(e){o._addRowGroup(e)}));e._rng.row2=r._rowInfo.length-1};return _RowGroupHandler}();o._RowGroupHandler=r;var t=function(o){__extends(_RowGroup,o);function _RowGroup(r,t){var n=o.call(this)||this;n._rng=new e.grid.CellRange(-1,0);n._cols=[];n._lvl=0;n._collapsed=!1;n._pGrp=t;n._lvl=0;for(var i=t;i;i=i._pGrp)n._lvl++;t&&t.columns.indexOf(n)<0&&t.columns.push(n);n._rng.col=n._rng.col2=n._lvl;n.allowDragging=!1;e.copy(n,r);return n}Object.defineProperty(_RowGroup.prototype,"columns",{get:function(){return this._cols},set:function(e){var o=this,r=this._cols=[];e.forEach((function(e){var t=new _RowGroup(e,o);r.indexOf(t)<0&&r.push(t)}))},enumerable:!0,configurable:!0});Object.defineProperty(_RowGroup.prototype,"rows",{get:function(){return this._cols},enumerable:!0,configurable:!0});Object.defineProperty(_RowGroup.prototype,"isEmpty",{get:function(){return 0===this._cols.length},enumerable:!0,configurable:!0});Object.defineProperty(_RowGroup.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!0,configurable:!0});Object.defineProperty(_RowGroup.prototype,"level",{get:function(){for(var e=this,o=0;e._pGrp;){e=e._pGrp;o++}return o},enumerable:!0,configurable:!0});Object.defineProperty(_RowGroup.prototype,"collapseTo",{get:function(){return this._collTo},set:function(o){e.assert(e.isArray(o)||e.isString(o),"collapseTo should be an array or a string.");this._collTo=o},enumerable:!0,configurable:!0});Object.defineProperty(_RowGroup.prototype,"isCollapsed",{get:function(){return this._collapsed},set:function(o){var r=this;if(o!=this._collapsed){var t=this._grid;if(t){var n=new e.grid.CellRangeEventArgs(t.rowHeaders,this._rng,this);if(t.onColumnGroupCollapsedChanging(n)){this._collapsed=e.asBoolean(o);t.onColumnGroupCollapsedChanged(n)}}else this._collapsed=e.asBoolean(o)}setTimeout((function(){r._updateCollapsedState()}))},enumerable:!0,configurable:!0});_RowGroup.prototype._copy=function(o,r){if(/rows|columns/.test(o)){var t=e.asArray(r);this.columns=t;return!0}return!1};_RowGroup.prototype._updateCollapsedState=function(){var e=this._grid._rowInfo,o=this._rng,r=this._collapsed;this._cols.forEach((function(e){if(e instanceof _RowGroup){e._collapsed=r;e._updateCollapsedState()}}));for(var t=this._getCollapseToIndices(),n=o.topRow;n<=o.bottomRow;n++)e[n].visible=!r||t.indexOf(n)>-1};_RowGroup.prototype._getMaxLevel=function(){var e=this._lvl;this.columns.forEach((function(o){e=Math.max(e,o._getMaxLevel())}));return e};_RowGroup.prototype._expandRange=function(e){var o=e-this._getMaxLevel();if(o>0){this._rng.col2+=o;this._cols.forEach((function(e){e._shiftRange(o)}))}for(var r=this._grid._rowInfo,t=this._rng,n=t.row;n<=t.row2;n++)r[n]._rng.col2=e};_RowGroup.prototype._shiftRange=function(e){this._rng.col+=e;this._rng.col2+=e;this._cols.forEach((function(o){o._shiftRange(e)}))};_RowGroup.prototype._getCollapseToBindings=function(){var o=this.collapseTo;return e.isString(o)?[o]:o};_RowGroup.prototype._getCollapseToIndices=function(){var e=this._grid,o=this._rng,r=this._getCollapseToBindings();if(r&&r.length){for(var t=[],n=e._rowInfo,i=0;i<r.length;i++)switch(r[i]){case"$first":t.push(o.topRow);break;case"$last":t.push(o.bottomRow);break;default:var s=n.indexOf(r[i]);s>-1&&t.push(s)}if(t.length)return t}return[o.bottomRow]};return _RowGroup}(e.grid.Column);o._RowGroup=t})((o=e.grid||(e.grid={})).transposed||(o.transposed={}))}(wijmo||(wijmo={}));!function(e){!function(o){o.transposed||(o.transposed={}),e._registerModule("wijmo.grid.transposed",e.grid.transposed)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));